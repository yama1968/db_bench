

select click, count(*) as nb from train group by click order by click
0	33563901
1	6865066
0.177
select banner_pos, count(*) as nb, avg(click) as p
       from train
       group by banner_pos
       order by banner_pos
0	29109590	0.16427235835338114
1	11247282	0.18361449459522755
2	13001	0.11922159833858934
3	2035	0.1828009828009828
4	7704	0.1853582554517134
5	5778	0.12149532710280374
7	43577	0.3201000527801363
0.446
select count(distinct device_type) from train
5
0.355
select device_type, count(*) as nb, avg(click) as p
       from train
       group by device_type
       order by nb desc
1	37304667	0.16917577631774597
0	2220812	0.21073148019733323
4	774272	0.09544449495784427
5	129185	0.09384216433796494
2	31	0.06451612903225806
0.276
select count(distinct device_id) from train
2689181
0.488
Code: 62. DB::Exception: Syntax error: failed at position 6 (line 1, col 6): view if exists device_id;
drop view if exists device_id_type;

create view device_id_type
       as select device_id, device_type, count(*) as nb 
       from t, expected TABLE


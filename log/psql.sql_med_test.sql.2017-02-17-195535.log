Timing is on.
 click |    nb    
-------+----------
     0 | 33563901
     1 |  6865066
(2 rows)

Time: 22910,421 ms
 banner_pos |    nb    |         p         
------------+----------+-------------------
 0          | 29109590 | 0.164272358353381
 1          | 11247282 | 0.183614494595228
 2          |    13001 | 0.119221598338589
 3          |     2035 | 0.182800982800983
 4          |     7704 | 0.185358255451713
 5          |     5778 | 0.121495327102804
 7          |    43577 | 0.320100052780136
(7 rows)

Time: 27188,725 ms
 count 
-------
     5
(1 row)

Time: 26860,161 ms
 device_type |    nb    |         p          
-------------+----------+--------------------
 1           | 37304667 |  0.169175776317746
 0           |  2220812 |  0.210731480197333
 4           |   774272 | 0.0954444949578443
 5           |   129185 | 0.0938421643379649
 2           |       31 | 0.0645161290322581
(5 rows)

Time: 29925,018 ms
  count  
---------
 2686408
(1 row)

Time: 29170,965 ms
psql:./sql_med_test.sql:21: NOTICE:  view "device_id" does not exist, skipping
DROP VIEW
Time: 0,372 ms
psql:./sql_med_test.sql:22: NOTICE:  view "device_id_type" does not exist, skipping
DROP VIEW
Time: 0,218 ms
CREATE VIEW
Time: 395,132 ms
CREATE VIEW
Time: 18,879 ms
 nnb | nb_device_id 
-----+--------------
   4 |            1
   3 |           13
   2 |         1465
(3 rows)

Time: 38393,916 ms
DROP VIEW
Time: 48,704 ms
DROP VIEW
Time: 7,011 ms
 device_id |    nb    |         p          
-----------+----------+--------------------
 a99f214a  | 33358308 |  0.174151968379212
 0f7c61dc  |    21356 |   0.75810076793407
 c357dbff  |    19667 |   0.63400620328469
 936e92fb  |    13712 | 0.0638127187864644
 afeffc18  |     9654 |  0.229024238657551
 987552d1  |     4187 |                  0
 28dc8687  |     4101 |                  0
 d857ffbb  |     4004 |  0.224775224775225
 cef4c8cc  |     3694 |  0.243909041689226
 b09da1c4  |     3655 |  0.131053351573187
 3cdb4052  |     3069 |  0.788856304985337
 03559b29  |     2528 |                  0
 02da5312  |     2497 |  0.128954745694834
 d2e4c0ab  |     1466 |                  0
 f1d9c744  |     1392 |                  0
 abab24a7  |     1374 |                  0
 096a6f32  |     1369 |                  0
 9af87478  |     1355 | 0.0929889298892989
 bbcf14e4  |     1182 |                  0
 73b81e30  |     1182 |  0.529610829103215
(20 rows)

Time: 36312,572 ms


SELECT
    hour,
    runningAccumulate(s) AS acc,
    runningAccumulate(t) as acct,
    clicked,
    runningDifference(clicked) as diff,
    cnt
FROM
(
    SELECT
        hour,
        sumState(click) AS s,
        sumState(1) AS t,
        sum(click) AS clicked,
        count(*) AS cnt
    FROM Train
    GROUP BY hour
    ORDER BY hour ASC
)
ORDER BY hour ASC
14102100	20792	119006	20792	0	119006
14102101	44665	256448	23873	3081	137442
14102102	75930	463919	31265	7392	207471
14102103	108760	657274	32830	1565	193355
14102104	148786	921985	40026	7196	264711
14102105	189495	1195485	40709	683	273500
14102106	228152	1435205	38657	-2052	239720
14102107	263683	1644516	35531	-3126	209311
14102108	298903	1851760	35220	-311	207244
14102109	336705	2082677	37802	2582	230917
14102110	372399	2282705	35694	-2108	200028
14102111	407875	2458371	35476	-218	175666
14102112	436650	2601991	28775	-6701	143620
14102113	472075	2792472	35425	6650	190481
14102114	507243	2967003	35168	-257	174531
14102115	541323	3143159	34080	-1088	176156
14102116	574792	3315028	33469	-611	171869
14102117	607349	3486961	32557	-912	171933
14102118	634819	3639326	27470	-5087	152365
14102119	655020	3759101	20201	-7269	119775
14102120	673215	3871118	18195	-2006	112017
14102121	688420	3960619	15205	-2990	89501
14102122	704303	4049055	15883	678	88436
14102123	718218	4122995	13915	-1968	73940
14102200	732552	4201001	14334	419	78006
14102201	751750	4301612	19198	4864	100611
14102202	771597	4404456	19847	649	102844
14102203	797061	4541462	25464	5617	137006
14102204	831438	4742410	34377	8913	200948
14102205	873359	5029107	41921	7544	286697
14102206	919586	5317926	46227	4306	288819
14102207	959172	5530249	39586	-6641	212323
14102208	1005659	5853052	46487	6901	322803
14102209	1068069	6300835	62410	15923	447783
14102210	1129257	6739105	61188	-1222	438270
14102211	1181475	7125862	52218	-8970	386757
14102212	1237592	7534512	56117	3899	408650
14102213	1280783	7857992	43191	-12926	323480
14102214	1315408	8043603	34625	-8566	185611
14102215	1349968	8228984	34560	-65	185381
14102216	1382236	8413300	32268	-2292	184316
14102217	1417202	8610212	34966	2698	196912
14102218	1451910	8815968	34708	-258	205756
14102219	1479708	8989571	27798	-6910	173603
14102220	1502384	9133946	22676	-5122	144375
14102221	1522809	9257772	20425	-2251	123826
14102222	1541131	9367144	18322	-2103	109372
14102223	1557038	9460121	15907	-2415	92977
14102300	1573992	9549462	16954	1047	89341
14102301	1593753	9651720	19761	2807	102258
14102302	1624396	9799700	30643	10882	147980
14102303	1657115	9974794	32719	2076	175094
14102304	1704171	10247967	47056	14337	273173
14102305	1743985	10482491	39814	-7242	234524
14102306	1768777	10621119	24792	-15022	138628
14102307	1799092	10781123	30315	5523	160004
14102308	1837422	11013553	38330	8015	232430
14102309	1872580	11198746	35158	-3172	185193
14102310	1906192	11361552	33612	-1546	162806
14102311	1939172	11523046	32980	-632	161494
14102312	1971322	11675459	32150	-830	152413
14102313	2003267	11837680	31945	-205	162221
14102314	2036431	12011517	33164	1219	173837
14102315	2077880	12257814	41449	8285	246297
14102316	2111021	12436006	33141	-8308	178192
14102317	2141423	12594338	30402	-2739	158332
14102318	2170180	12752097	28757	-1645	157759
14102319	2192567	12884980	22387	-6370	132883
14102320	2212632	13018025	20065	-2322	133045
14102321	2229791	13134989	17159	-2906	116964
14102322	2246545	13240641	16754	-405	105652
14102323	2262249	13330873	15704	-1050	90232
14102400	2277002	13413010	14753	-951	82137
14102401	2294635	13507632	17633	2880	94622
14102402	2319717	13632635	25082	7449	125003
14102403	2342194	13756480	22477	-2605	123845
14102404	2369591	13918010	27397	4920	161530
14102405	2398379	14086195	28788	1391	168185
14102406	2428071	14256037	29692	904	169842
14102407	2460539	14437640	32468	2776	181603
14102408	2492009	14610882	31470	-998	173242
14102409	2521058	14778637	29049	-2421	167755
14102410	2546637	14925330	25579	-3470	146693
14102411	2571575	15061113	24938	-641	135783
14102412	2606199	15249520	34624	9686	188407
14102413	2641573	15438578	35374	750	189058
14102414	2681840	15655723	40267	4893	217145
14102415	2720538	15862406	38698	-1569	206683
14102416	2761729	16114560	41191	2493	252154
14102417	2803184	16377139	41455	264	262579
14102418	2829143	16548023	25959	-15496	170884
14102419	2833226	16582186	4083	-21876	34163
14102420	2836409	16605310	3183	-900	23124
14102421	2839078	16625677	2669	-514	20367
14102422	2841351	16640553	2273	-396	14876
14102423	2844979	16666175	3628	1355	25622
14102500	2858537	16739621	13558	9930	73446
14102501	2873657	16820258	15120	1562	80637
14102502	2878100	16858658	4443	-10677	38400
14102503	2887624	16926101	9524	5081	67443
14102504	2901773	17002917	14149	4625	76816
14102505	2923194	17120124	21421	7272	117207
14102506	2931595	17171850	8401	-13020	51726
14102507	2959711	17308248	28116	19715	136398
14102508	2987507	17457708	27796	-320	149460
14102509	3018944	17637768	31437	3641	180060
14102510	3050727	17820079	31783	346	182311
14102511	3085983	18015586	35256	3473	195507
14102512	3124437	18221500	38454	3198	205914
14102513	3171489	18459571	47052	8598	238071
14102514	3217053	18702071	45564	-1488	242500
14102515	3262588	18940498	45535	-29	238427
14102516	3302585	19150564	39997	-5538	210066
14102517	3340387	19355884	37802	-2195	205320
14102518	3373164	19547257	32777	-5025	191373
14102519	3395125	19669404	21961	-10816	122147
14102520	3412578	19770361	17453	-4508	100957
14102521	3428779	19863083	16201	-1252	92722
14102522	3444246	19952791	15467	-734	89708
14102523	3458419	20029297	14173	-1294	76506
14102600	3471575	20101482	13156	-1017	72185
14102601	3486743	20182345	15168	2012	80863
14102602	3506231	20283166	19488	4320	100821
14102603	3527997	20395188	21766	2278	112022
14102604	3558319	20545372	30322	8556	150184
14102605	3591656	20716495	33337	3015	171123
14102606	3625686	20895640	34030	693	179145
14102607	3662154	21095816	36468	2438	200176
14102608	3697670	21284597	35516	-952	188781
14102609	3733971	21486499	36301	785	201902
14102610	3772300	21706329	38329	2028	219830
14102611	3815814	21945641	43514	5185	239312
14102612	3860192	22183456	44378	864	237815
14102613	3903771	22419747	43579	-799	236291
14102614	3946783	22653587	43012	-567	233840
14102615	3985874	22860410	39091	-3921	206823
14102616	4024039	23061819	38165	-926	201409
14102617	4055742	23244973	31703	-6462	183154
14102618	4082569	23398788	26827	-4876	153815
14102619	4102658	23515744	20089	-6738	116956
14102620	4119998	23617420	17340	-2749	101676
14102621	4132671	23699550	12673	-4667	82130
14102622	4146944	23788419	14273	1600	88869
14102623	4160575	23865189	13631	-642	76770
14102700	4171878	23927443	11303	-2328	62254
14102701	4187770	24002825	15892	4589	75382
14102702	4203526	24088653	15756	-136	85828
14102703	4224412	24209199	20886	5130	120546
14102704	4249809	24345883	25397	4511	136684
14102705	4281492	24514425	31683	6286	168542
14102706	4313022	24686942	31530	-153	172517
14102707	4343850	24849285	30828	-702	162343
14102708	4373789	25012839	29939	-889	163554
14102709	4402556	25164905	28767	-1172	152066
14102710	4420217	25266154	17661	-11106	101249
14102711	4439789	25384426	19572	1911	118272
14102712	4468727	25550655	28938	9366	166229
14102713	4502433	25723707	33706	4768	173052
14102714	4525497	25828885	23064	-10642	105178
14102715	4546438	25933127	20941	-2123	104242
14102716	4581218	26112783	34780	13839	179656
14102717	4623329	26346935	42111	7331	234152
14102718	4656961	26549210	33632	-8479	202275
14102719	4683428	26707172	26467	-7165	157962
14102720	4700475	26814763	17047	-9420	107591
14102721	4715206	26908010	14731	-2316	93247
14102722	4730663	27002992	15457	726	94982
14102723	4746218	27090199	15555	98	87207
14102800	4761645	27172719	15427	-128	82520
14102801	4782049	27275467	20404	4977	102748
14102802	4808182	27450159	26133	5729	174692
14102803	4827044	27570258	18862	-7271	120099
14102804	4852592	27710831	25548	6686	140573
14102805	4886535	27896727	33943	8395	185896
14102806	4916955	28083790	30420	-3523	187063
14102807	4952639	28294548	35684	5264	210758
14102808	4990554	28586311	37915	2231	291763
14102809	5031197	28914887	40643	2728	328576
14102810	5067907	29173543	36710	-3933	258656
14102811	5107274	29431434	39367	2657	257891
14102812	5151934	29703558	44660	5293	272124
14102813	5211014	30135866	59080	14420	432308
14102814	5267602	30523319	56588	-2492	387453
14102815	5314799	30805634	47197	-9391	282315
14102816	5361854	31089125	47055	-142	283491
14102817	5405100	31369960	43246	-3809	280835
14102818	5439562	31602306	34462	-8784	232346
14102819	5467727	31803378	28165	-6297	201072
14102820	5492094	31973459	24367	-3798	170081
14102821	5516469	32139675	24375	8	166216
14102822	5534334	32263870	17865	-6510	124195
14102823	5550840	32377421	16506	-1359	113551
14102900	5565332	32476371	14492	-2014	98950
14102901	5582918	32595285	17586	3094	118914
14102902	5607213	32736459	24295	6709	141174
14102903	5647807	32964516	40594	16299	228057
14102904	5671864	33125439	24057	-16537	160923
14102905	5691058	33257179	19194	-4863	131740
14102906	5712050	33400058	20992	1798	142879
14102907	5746614	33628963	34564	13572	228905
14102908	5777422	33830530	30808	-3756	201567
14102909	5803351	34016794	25929	-4879	186264
14102910	5834870	34240901	31519	5590	224107
14102911	5861951	34402432	27081	-4438	161531
14102912	5891373	34594821	29422	2341	192389
14102913	5922350	34788148	30977	1555	193327
14102914	5958103	35012385	35753	4776	224237
14102915	5992121	35214789	34018	-1735	202404
14102916	6020835	35392145	28714	-5304	177356
14102917	6045311	35550877	24476	-4238	158732
14102918	6065366	35683116	20055	-4421	132239
14102919	6084352	35808537	18986	-1069	125421
14102920	6103082	35925554	18730	-256	117017
14102921	6118221	36021306	15139	-3591	95752
14102922	6133317	36111671	15096	-43	90365
14102923	6150881	36210029	17564	2468	98358
14103000	6168541	36297362	17660	96	87333
14103001	6186853	36388669	18312	652	91307
14103002	6205223	36487128	18370	58	98459
14103003	6223806	36608662	18583	213	121534
14103004	6260785	36956468	36979	18396	347806
14103005	6293838	37201233	33053	-3926	244765
14103006	6325443	37393637	31605	-1448	192404
14103007	6354767	37549528	29324	-2281	155891
14103008	6383406	37714948	28639	-685	165420
14103009	6420371	37910833	36965	8326	195885
14103010	6454958	38126646	34587	-2378	215813
14103011	6494296	38346456	39338	4751	219810
14103012	6535221	38595478	40925	1587	249022
14103013	6577236	38845919	42015	1090	250441
14103014	6621042	39105106	43806	1791	259187
14103015	6662647	39337800	41605	-2201	232694
14103016	6701806	39549716	39159	-2446	211916
14103017	6734734	39727294	32928	-6231	177578
14103018	6765798	39886864	31064	-1864	159570
14103019	6791844	40021107	26046	-5018	134243
14103020	6812664	40131871	20820	-5226	110764
14103021	6833622	40244109	20958	138	112238
14103022	6850950	40345359	17328	-3630	101250
14103023	6865066	40428967	14116	-3212	83608
0.558

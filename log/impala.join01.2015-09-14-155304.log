Starting Impala Shell without Kerberos authentication
Connected to quickstart.cloudera:21000
Server version: impalad version 2.2.0-cdh5.4.2 RELEASE (build b7f0e80e29971632ae1c422243d56c9ef65b8c5b)
Query: drop view if exists device_id_nb_tmp
Query: create view device_id_nb_tmp
as select device_id, cast(count(*) as integer) as nnb, avg(click) as p
from train
group by device_id
[?1034hWelcome to the Impala shell. Press TAB twice to see a list of available commands.

Copyright (c) 2012 Cloudera, Inc. All rights reserved.

(Shell build version: Impala Shell v2.2.0-cdh5.4.2 (b7f0e80) built on Tue May 19 16:45:28 PDT 2015)
[quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] >                             >                             >                             > 
Fetched 0 row(s) in 0.06s
Query: drop table if exists train_features
Query: create table train_features
(id string, hour string, click integer, device_id string, p double, nb integer)
[quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] >                             > 
Fetched 0 row(s) in 0.21s
Query: insert into train_features
select t.id, t.hour, t.click, t.device_id, p, nnb
from train as t, device_id_nb_tmp
where t.device_id = device_id_nb_tmp.device_id
Inserted 40428968 row(s) in 91.89s
Query: select click, count(*) from train_features group by click order by click
[quickstart.cloudera:21000] > [quickstart.cloudera:21000] >                             >                             >                             > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > +-------+----------+
| click | count(*) |
+-------+----------+
| 0     | 33563902 |
| 1     | 6865066  |
+-------+----------+
Fetched 2 row(s) in 30.89s
Query: drop table train_features
Query: drop view device_id_nb_tmp
Goodbye cloudera
[quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > [quickstart.cloudera:21000] > 
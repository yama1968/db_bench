:0[0]:W
sSET TIME ZONE INTERVAL '+01:00' HOUR TO MINUTE;
:0[0]:R
&3
:0[0]:R
:0[0]:W
S
:0[0]:R
:0[0]:W
Sdrop view  numbers_per_day;
:1[0]:R
!42S02!DROP VIEW: unknown view 'numbers_per_day'
:1[0]:R
:1[0]:W
Sdrop view  device_id_ip_number;
:1[0]:R
!42S02!DROP VIEW: unknown view 'device_id_ip_number'
:1[0]:R
:1[0]:W
Sdrop view  device_id_ip_seq;
:1[0]:R
!42S02!DROP VIEW: unknown view 'device_id_ip_seq'
:1[0]:R
:1[0]:W
Sdrop view  train2;
:2[0]:R
!42S02!DROP VIEW: unknown view 'train2'
:2[0]:R
:2[0]:W
S
:2[0]:R
:2[0]:W
S
:2[0]:R
:2[0]:W
Screate view train2
:2[0]:R

:2[0]:R
       as select *, substring(hour, 1, 6) as day from train;
:2[0]:R
!42000!syntax error, unexpected HOUR in: "create view train2
!       as select *, substring(hour"
:2[0]:R
:2[0]:W
S
:2[0]:R
:2[0]:W
Screate view device_id_ip_seq
:2[0]:R

:2[0]:R
  as select device_id, device_ip, day, hour, 
:2[0]:R

:2[0]:R
   	    row_number() over (partition by device_id, device_ip, day order by device_id, device_ip, hour) as row_number
:2[0]:R

:2[0]:R
       from train2;
:2[0]:R
!42000!syntax error, unexpected DAY in: "create view device_id_ip_seq
!  as select device_id, device_ip, day"
:2[0]:R
:2[0]:W
S
:2[0]:R
:2[0]:W
Sselect count(*)
:3[0]:R

:3[0]:R
  from device_id_ip_seq;
:3[0]:R
!42S02!SELECT: no such table 'device_id_ip_seq'
:3[0]:R
:3[0]:W
S
:3[0]:R
:3[0]:W
Sselect * from device_id_ip_seq limit 10;
:3[0]:R
!42S02!SELECT: no such table 'device_id_ip_seq'
:3[0]:R
:3[0]:W
S
:3[0]:R
:3[0]:W
S
:3[0]:R
:3[0]:W
Screate view device_id_ip_number
:3[0]:R

:3[0]:R
  as select device_id, device_ip, day, max(row_number) as number
:3[0]:R

:3[0]:R
       from device_id_ip_seq
:3[0]:R

:3[0]:R
   group by device_id, device_ip, day;
:3[0]:R
!42000!syntax error, unexpected DAY in: "create view device_id_ip_number
!  as select device_id, device_ip, day"
:3[0]:R
:3[0]:W
S
:3[0]:R
:3[0]:W
Sselect * from device_id_ip_number limit 10;
:3[0]:R
!42S02!SELECT: no such table 'device_id_ip_number'
:3[0]:R
:3[0]:W
S
:3[0]:R
:3[0]:W
S
:3[0]:R
:3[0]:W
Screate view numbers_per_day
:3[0]:R

:3[0]:R
  as select day, number, count(*) as count_devices
:3[0]:R

:3[0]:R
       from device_id_ip_number
:3[0]:R

:3[0]:R
   group by day, number;
:3[0]:R
!42000!syntax error, unexpected DAY in: "create view numbers_per_day
!  as select day"
:3[0]:R
:4[0]:W
S
:4[0]:R
:4[0]:W
S  select * 
:4[0]:R

:4[0]:R
    from numbers_per_day
:4[0]:R

:4[0]:R
order by day, number;
:4[0]:R
!42000!syntax error, unexpected DAY in: "  select * 
!    from numbers_per_day
!order by day"
:4[0]:R
:4[0]:W
S
:4[0]:R
:4[0]:W
Connection closed

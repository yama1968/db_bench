Timing is on.
 click |    nb    
-------+----------
     0 | 33563901
     1 |  6865066
(2 rows)

Time: 7340,956 ms
 banner_pos |    nb    |           p            
------------+----------+------------------------
 0          | 29109590 | 0.16427235835338113659
 1          | 11247282 | 0.18361449459522754031
 2          |    13001 | 0.11922159833858933928
 3          |     2035 | 0.18280098280098280098
 4          |     7704 | 0.18535825545171339564
 5          |     5778 | 0.12149532710280373832
 7          |    43577 | 0.32010005278013631044
(7 rows)

Time: 10042,650 ms
 count 
-------
     5
(1 row)

Time: 132867,285 ms
 device_type |    nb    |           p            
-------------+----------+------------------------
 1           | 37304667 | 0.16917577631774598068
 0           |  2220812 | 0.21073148019733322767
 4           |   774272 | 0.09544449495784427178
 5           |   129185 | 0.09384216433796493401
 2           |       31 | 0.06451612903225806452
(5 rows)

Time: 13886,136 ms
  count  
---------
 2686408
(1 row)

Time: 412325,993 ms
psql:./sql_med_test.sql:21: NOTICE:  view "device_id" does not exist, skipping
DROP VIEW
Time: 0,311 ms
psql:./sql_med_test.sql:22: NOTICE:  view "device_id_type" does not exist, skipping
DROP VIEW
Time: 0,122 ms
CREATE VIEW
Time: 11,548 ms
CREATE VIEW
Time: 2,274 ms
 nnb | nb_device_id 
-----+--------------
   4 |            1
   3 |           13
   2 |         1465
(3 rows)

Time: 555981,205 ms
DROP VIEW
Time: 8,421 ms
DROP VIEW
Time: 1,369 ms
